<%- include('partials/header') %>


<div class="container mt-5">
  <div class="signBox">
    <h4 class="text-warning"><i class="fa-solid fa-square-poll-vertical"></i> <%= voteSession.title %></h4>
    <div class="card mt-5 bg-dark controlPanelCodeBox" style="width: 40rem;">
      <div class="card-body">
        <% if (voteSession && voteSession.questions.length > 0) { %>
          <% const currentQuestion = voteSession.questions[voteSession.voteFlag]; %>
          <h4 class="card-title">
            <span class="text-warning">Question <%= currentQuestion.questionNumber %>:</span> <%= currentQuestion.questionText %>
          </h4>
          <% const questionVoteCounts = voteCounts[currentQuestion.questionNumber]; %>
          <% let totalVotes = 0; %>
          <% currentQuestion.options.forEach(function(option) { %>
            <% totalVotes += questionVoteCounts[option] || 0; %>
          <% }); %>




          <h5 class="card-text">
            <span class="text-light">
              <form action="/organizer/dashboard/questionPanel/<%= voteSession._id %>" method="POST">
                <div class="w-100">
                  <% currentQuestion.options.forEach(function(option, index) { %>
                    <% const count = questionVoteCounts[option] || 0; %>
                    <% const percentage = totalVotes > 0 ? (count / totalVotes) * 100 : 0; %>
                    <div class="option-container mb-2">
                      <div class="option-text text-light">
                        <%= option %> (<span class="text-info"><%= count %> vote<%= count !== 1 ? 's' : '' %></span>)
                      </div>
                      <div class="progress">
                        <div class="progress-bar bg-warning progress-bar-striped progress-bar-animated" role="progressbar" style="width: <%= percentage %>%;" aria-valuenow="<%= percentage %>" aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                    </div>
                  <% }); %>
                </div>
                <button type="submit" class="btn btn-outline-warning mt-3 w-50">Next</button>
              </form>
            </span>
          </h5>



          
        <% } else { %>
          <h4 class="card-title">No questions available</h4>
        <% } %>
      </div>
    </div>
  </div>
</div>






<script>
  setTimeout(function() {
      window.location.reload(1);
  }, 1000);  // Refresh every 1 seconds (1000 ms)
</script>


<%- include('partials/footer') %>
